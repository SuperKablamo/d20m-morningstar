{% extends "main.html" %}

		{% block title %}
		<title>d20morningstar - Character Quest</title> 
		{% endblock %}
		
		{% block script %}
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&language=en"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.js"></script>
		<script type="text/javascript">
		$(function() {
			$('#quest').bind('pageshow', function() {
        var success = function(position) {   
					var coords = position.coords;
          var url = "http://maps.google.com/maps/api/staticmap?center=" + coords.latitude + "," + coords.longitude + "&zoom=14&size=320x140&maptype=roadmap&key=ABQIAAAApPeof0WyN6ORT7NeNop5OxQhS8mdepxW5-6qUjpskYmhafYcLRQjyW8D0bRdsydbD1maEkV9aSDKrw&sensor=true&markers=icon:http://morningstar.d20m.com/static/images/mark-player-32x48.png%7C" + coords.latitude + "," + coords.longitude;
          document.getElementById('map').setAttribute('src',url);
        };
        var fail = function(e) {
             alert('Can\'t retrieve position.\nError: ' + e);
        };
        navigator.geolocation.getCurrentPosition(success, fail);				
			});
		});
		$('#perception-check').bind('click', function() {
			$.getJSON('/mobile/')
			
		});
	
		</script>
		{% endblock %}
		
		{% block jquery-mobile-script %}
		<script>
			$(document).ready(function() {
		  	// disable ajax nav
		  	$.mobile.ajaxLinksEnabled = false;
		 	});
		</script>	
    
		<script type="text/javascript">
    	$(document).bind("mobileinit", function()	{
      	$.extend($.mobile, {
          ajaxFormsEnabled: false
      	});
    	});
    </script>		
		{% endblock %}
			
		{% block page-id %}
		<div data-role="page" id="quest">
		{% endblock %}			
			
		{% block header %}
		<div data-role="header" data-theme="d">
			<h1>{{player.name}}</h1>
		</div><!-- /header -->			
		{% endblock %}
			
			
			{% block content %}
			<div data-role="content" id="content">	
				<table summary="This table contains player stats.">
					<tbody>
						<tr>	
							<th>hp</th>
							<td>{{player.hit_points.hp}}</td>
							<th>xp</th>
							<td>{{player.experience}}</td>
							<th>gp</th>
							<td>{{player.purse.gold}}</td>
						</tr>					
					</tbody>	
				</table>	
				
				<table summary="This table contains player powers.">
					<tbody>
						{% for a in player.powers.attacks %}
						<tr>
							<td>{{a.name}}</td>
							<td>{{a.attack_mod}}</td>
							<th>dmg</th>
							<td>{{a.damage_dice}}d{{a.damage_die}}</td>
							<th>recharge</th>
							<td>{{a.recharge}}</td>
						</tr>	
						{% endfor %}
					</tbody>
				</table>	

				<div id="map-canvas">
					<img id="map" />
				</div><!-- /map -->	

			</div><!-- /content -->
			{% endblock %}

			{% block footer %}
			<div data-role="footer" data-theme="d" data-position="fixed" id="footer">
				<a href="#" data-role="button" data-theme="b" id="perception-check" class="button">PERCEPTION CHECK</a>
			</div><!-- /footer -->			
			{% endblock %}			

